<!DOCTYPE html>
<html lang="fr">
<head>
  <!--
    PowerPoint Generator Pro - v2.1
    
    Corrections v2.1:
    1. âœ… SystÃ¨me d'avertissements pour contenu long (titres >50 car, bullets >12 mots, tables >5 cols/8 rows)
    2. âœ… Dimensions adaptatives pour tables (largeur et hauteur calculÃ©es selon contenu)
    3. âœ… Ajustement automatique de la taille de police selon longueur du texte
    4. âœ… Limitation automatique Ã  4 bullets maximum par slide (Ã©vite dÃ©bordement)
    5. âœ… Wrapping activÃ© pour cellules de tableau
    6. âœ… Hauteur et largeur de colonnes/rangÃ©es calculÃ©es dynamiquement
    
    Ces corrections rÃ©solvent les problÃ¨mes:
    - Contenu sortant du cadre des slides
    - Tables avec trop de colonnes/rangÃ©es
    - Texte trop long dans les cellules
  -->
  
  <!-- Content Security Policy pour sÃ©curitÃ© maximale -->
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'none'; script-src 'self'; style-src 'self'; img-src 'self' data:; font-src 'self' data:; connect-src 'none'; frame-ancestors 'none'; base-uri 'self'; form-action 'self';">
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="GÃ©nÃ©rateur de prÃ©sentations PowerPoint professionnel avec IA">
  <title>PowerPoint Generator Pro - v2.1</title>
  
  <!-- Chargement LOCAL de PptxGenJS -->
  <script src="./pptxgen.bundle.js" defer></script>

  <link rel="stylesheet" href="src/css/app.css">

</head>
<body>
  <div class="header">
    <div class="logo">
      <div class="logo-icon" role="img" aria-label="PowerPoint Generator Pro Logo">PP</div>
      <h1>PowerPoint Generator Pro</h1>
    </div>
    <div class="subtitle">Solution professionnelle amÃ©liorÃ©e de gÃ©nÃ©ration de prÃ©sentations - v2.1 (Anti-dÃ©bordement)
    <div class="security-badge">
      <span role="img" aria-label="Lock">ğŸ”’</span>
      <span>100% Offline & SÃ©curisÃ©</span>
    </div>
  </div>

  <div class="container">
    <!-- Barre d'action principale -->
    <div class="action-bar">
      <div class="action-info">
        <div class="status-indicator" role="status" aria-live="polite">
          <span class="status-dot" id="statusDot" aria-hidden="true"></span>
          <span id="statusText">VÃ©rification...</span>
        </div>
        <div class="validation-status" id="validationStatus" role="status" aria-live="polite">
          <span id="validationText"></span>
        </div>
      </div>
      <div class="action-buttons">
        <button
          class="btn btn-secondary"
          id="templatesBtn"
          aria-label="Charger un template prÃ©-dÃ©fini">
          ğŸ“„ Templates
        </button>
        <button
          class="btn btn-secondary"
          id="historyBtn"
          aria-label="Voir l'historique des gÃ©nÃ©rations">
          ğŸ“œ Historique
        </button>
        <button
          class="btn-generate-main"
          id="generateBtn"
          aria-label="GÃ©nÃ©rer la prÃ©sentation PowerPoint"
          disabled>
          <span class="btn-icon" aria-hidden="true">â–¶</span>
          <span>GÃ©nÃ©rer PowerPoint</span>
        </button>
      </div>
    </div>
    
    <div class="layout">
      <!-- Panel Prompt -->
      <div class="panel">
        <div class="panel-header">
          <span class="panel-title">
            <span class="panel-badge" aria-hidden="true">1</span>
            Prompt Template IA
          </span>
          <button
            class="btn btn-primary"
            id="copyPromptBtn"
            aria-label="Copier le prompt template dans le presse-papiers">
            ğŸ“‹ Copier le prompt
          </button>
        </div>
        <div class="panel-content">
          <div 
            class="prompt-content" 
            id="prompt"
            role="region"
            aria-label="Prompt template pour l'IA">Tu es un gÃ©nÃ©rateur de contenu pour prÃ©sentations PowerPoint professionnelles.
Tu dois produire UNIQUEMENT un objet JSON valide, sans texte avant/aprÃ¨s, sans balises markdown, sans commentaires.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CONTEXTE Ã€ DÃ‰FINIR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SUJET : [votre sujet]
NOMBRE_SLIDES : [nombre ou AUTO]
STYLE : [professionnel|crÃ©atif|acadÃ©mique|commercial]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
RÃˆGLES ABSOLUES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… JSON STRICT :
â€¢ UTF-8, guillemets doubles uniquement
â€¢ Ã‰chapper guillemets internes avec \"
â€¢ Pas de virgules finales, pas de commentaires
â€¢ Nombres dans tableaux = chaÃ®nes ("45%", "2.5Mâ‚¬")
â€¢ Nombres dans graphiques = nombres purs (45, 2.5)

âœ… CONTRAINTES :
â€¢ Titres : max 60 caractÃ¨res
â€¢ Bullets : 3-5 par slide, max 15 mots
â€¢ Tables : max 4 colonnes Ã— 10 lignes
â€¢ PremiÃ¨re slide = type "title"
â€¢ DerniÃ¨re slide = type "content" avec call-to-action

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STRUCTURE JSON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{
  "metadata": {
    "title": "Titre de la prÃ©sentation",
    "fileName": "nom-fichier.pptx",
    "author": "Auteur",
    "expectedSlideCount": 10
  },
  "slides": [
    {
      "type": "title",
      "title": "Titre principal",
      "subtitle": "Sous-titre"
    },
    {
      "type": "content", 
      "title": "Titre de slide",
      "bullets": [
        "Point 1 (max 15 mots)",
        "Point 2",
        "Point 3"
      ]
    },
    {
      "type": "twoColumn",
      "title": "Titre",
      "leftContent": ["Point 1", "Point 2"],
      "rightContent": ["Point 1", "Point 2"]
    },
    {
      "type": "table",
      "title": "Titre",
      "tableData": [
        ["En-tÃªte 1", "En-tÃªte 2", "En-tÃªte 3"],
        ["DonnÃ©e", "45%", "2.5Mâ‚¬"]
      ]
    },
    {
      "type": "chart",
      "title": "Titre",
      "chartType": "bar",
      "data": [
        { "label": "Q1", "value": 45 },
        { "label": "Q2", "value": 52 },
        { "label": "Q3", "value": 48 }
      ]
    },
    {
      "type": "image",
      "title": "Titre",
      "imagePath": "IMAGE_PLACEHOLDER_description"
    }
  ]
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TYPES DISPONIBLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â€¢ title : Slide d'ouverture
â€¢ content : Contenu avec bullets  
â€¢ twoColumn : Deux colonnes
â€¢ table : Tableau de donnÃ©es
â€¢ chart : Graphique (bar, line, pie)
â€¢ image : Image ou placeholder

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GÃ‰NÃˆRE UNIQUEMENT LE JSON, SANS TEXTE AVANT/APRÃˆS.</div>
        </div>
      </div>

      <!-- Panel JSON -->
      <div class="panel">
        <div class="panel-header">
          <span class="panel-title">
            <span class="panel-badge" aria-hidden="true">2</span>
            JSON de l'IA
          </span>
          <div class="panel-actions">
            <button
              class="btn"
              id="clearJsonBtn"
              aria-label="Effacer le contenu JSON">
              ğŸ—‘ï¸ Effacer
            </button>
            <button
              class="btn btn-success"
              id="importJsonBtn"
              aria-label="Importer un fichier JSON">
              ğŸ“‚ Importer
            </button>
            <button
              class="btn btn-success"
              id="exportJsonBtn"
              aria-label="Exporter le JSON vers un fichier">
              ğŸ’¾ Exporter
            </button>
          </div>
        </div>
        <div class="panel-content">
          <textarea 
            id="jsonInput" 
            placeholder="Collez ici le JSON gÃ©nÃ©rÃ© par l'IA...

Exemple:
{
  &quot;metadata&quot;: {
    &quot;title&quot;: &quot;Ma PrÃ©sentation&quot;,
    &quot;fileName&quot;: &quot;presentation.pptx&quot;,
    &quot;expectedSlideCount&quot;: 5
  },
  &quot;slides&quot;: [...]
}"
            spellcheck="false"
            aria-label="Zone de saisie pour le JSON de l'IA"
            aria-describedby="validationErrors"
          ></textarea>
          <div class="validation-errors" id="validationErrors" role="alert"></div>
        </div>
      </div>
    </div>

    <!-- Instructions -->
    <div class="instructions">
      <div class="instructions-title">Mode d'emploi</div>
      <div class="instructions-grid">
        <div class="instruction-item">
          <div class="instruction-number" aria-hidden="true">1</div>
          <div class="instruction-text">
            Copiez le prompt template et collez-le dans votre IA (ChatGPT, Claude, etc.)
          </div>
        </div>
        <div class="instruction-item">
          <div class="instruction-number" aria-hidden="true">2</div>
          <div class="instruction-text">
            Personnalisez le contexte (sujet, nombre de slides, style) dans le prompt
          </div>
        </div>
        <div class="instruction-item">
          <div class="instruction-number" aria-hidden="true">3</div>
          <div class="instruction-text">
            Copiez le JSON gÃ©nÃ©rÃ© par l'IA et collez-le dans le panel de droite
          </div>
        </div>
        <div class="instruction-item">
          <div class="instruction-number" aria-hidden="true">4</div>
          <div class="instruction-text">
            La validation en temps rÃ©el vous indiquera les erreurs Ã©ventuelles
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast notification -->
  <div class="toast" id="toast" role="alert" aria-live="assertive"></div>

  <!-- Templates Modal -->
  <div class="modal" id="templatesModal" role="dialog" aria-labelledby="templatesModalTitle" aria-modal="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="templatesModalTitle">Templates PrÃ©-dÃ©finis</h2>
        <button class="modal-close" id="closeTemplatesBtn" aria-label="Fermer la fenÃªtre">Ã—</button>
      </div>
      <div class="modal-body">
        <p class="modal-description">
          Choisissez un template pour dÃ©marrer rapidement
        </p>
        <div class="template-grid" id="templateGrid"></div>
      </div>
    </div>
  </div>

  <!-- History Modal -->
  <div class="modal" id="historyModal" role="dialog" aria-labelledby="historyModalTitle" aria-modal="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="historyModalTitle">Historique des GÃ©nÃ©rations</h2>
        <button class="modal-close" id="closeHistoryBtn" aria-label="Fermer la fenÃªtre">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="history-list" id="historyList"></div>
      </div>
    </div>
  </div>

  <!-- Hidden file input for import -->
  <input type="file" id="fileInput" class="hidden-file-input" accept=".json">

  <script src="src/js/validator.js" defer></script>
  <script src="src/js/app.js" defer></script>
</body>
</html>
